<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <title>YouTube Altyazı Çevirici v1.2</title>
    <link rel="icon" href="https://emojicdn.elk.sh/📹" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 50px;
        }

        h1 {
            font-size: 24px;
            margin-bottom: 15px;
        }

        input, button {
            padding: 8px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        button {
            cursor: pointer;
        }

        .loading {
            color: #007bff;
        }

        .success {
            color: #28a745;
        }

        .error {
            color: #dc3545;
        }
    </style>
</head>

<body>
    <h1>📹 YouTube Altyazı Çevirici v1.2</h1>

    <label for="youtubeURL">YouTube URL:</label><br>
    <input type="text" id="youtubeURL" size="60"><br>

    <label for="targetLang">Hedef Dil (örnek: tr, es, de):</label><br>
    <input type="text" id="targetLang" size="10"><br>

    <button onclick="processSubtitles()">Çevir</button>

    <div id="result"></div>

    <script>
        async function processSubtitles() {
            const url = document.getElementById("youtubeURL").value;
            const targetLang = document.getElementById("targetLang").value;
            const resultDiv = document.getElementById("result");

            resultDiv.innerHTML = "🌐 <span class='loading'>İşleniyor, lütfen bekleyin...</span>";

            const response = await fetch("https://api.elosito.com/process", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ url, target_lang: targetLang })
            });

            const data = await response.json();

            if (response.status === 202 && data.status === "ok") {
                const checkStatus = setInterval(async () => {
                    const statusResponse = await fetch(`https://api.elosito.com/status/${data.job_id}`);
                    const statusData = await statusResponse.json();

                    if (statusData.status === "completed") {
                        clearInterval(checkStatus);

                        const subtitleLang = statusData.subtitle_lang;
                        const videoId = statusData.video_id;
                        const firstChar = videoId[0].toUpperCase();

                        resultDiv.innerHTML = `
                            🎉 <span class='success'>İşlem Tamamlandı!</span><br><br>
                            📌 <b>Orijinal (${subtitleLang}):</b><br>
                            - <a href="https://elosito.com/${subtitleLang}/original/${firstChar}/${videoId}.json" target="_blank">JSON İndir</a><br>
                            - <a href="https://elosito.com/${subtitleLang}/original/${firstChar}/${videoId}.txt" target="_blank">TXT İndir</a><br><br>
                            
                            📌 <b>Çeviri (${targetLang}):</b><br>
                            - <a href="https://elosito.com/${subtitleLang}/translated/${targetLang}/${firstChar}/${videoId}.json" target="_blank">JSON İndir</a><br>
                            - <a href="https://elosito.com/${subtitleLang}/translated/${targetLang}/${firstChar}/${videoId}.txt" target="_blank">TXT İndir</a>
                        `;

                    } else if (statusData.status === "error") {
                        clearInterval(checkStatus);
                        resultDiv.innerHTML = `❌ <span class='error'>Hata: ${statusData.message}</span>`;
                    }
                }, 5000);

            } else {
                resultDiv.innerHTML = `❌ <span class='error'>Hata: ${data.message}</span>`;
            }
        }
    </script>
</body>

</html>
